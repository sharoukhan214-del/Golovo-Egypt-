<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="stylesheet" href="Style.css">
    <title>ุญุฌุฒ ูุฌุจุงุช</title>
</head>
<body>
    <div class="card">
        <h3 id="displayMealName">ูุฌุจุฉ ูุงุฆุถุฉ</h3>
        <p>ุงูุณุนุฑ: <span id="displayPrice">50</span> ุฌ.ู</p>
        <p style="color:red">๐ฅ ูุชุจูู: <span id="stockCount">100</span> ูุฌุจุฉ</p>
        
        <label>ุญุฏุฏ ุงููููุฉ ุงููู ูุญุชุงุฌูุง:</label>
        <input type="number" id="orderQty" value="1" min="1" oninput="updateBill()">

        <div id="billBox" style="background:#eee; padding:15px; border-radius:10px; margin:15px 0;">
            </div>

        <button onclick="goToPay()" class="btn-main">ุชุฃููุฏ ูุงุฐูุจ ููุฏูุน</button>
    </div>

    <script>
        function updateBill() {
            const price = parseFloat(document.getElementById('displayPrice').innerText);
            const qty = parseInt(document.getElementById('orderQty').value);
            const stock = parseInt(document.getElementById('stockCount').innerText);
            const box = document.getElementById('billBox');

            if(qty > stock) { alert("ุงููุชุงุญ ุบูุฑ ูุงูู!"); return; }

            let toPayNow = 0; // ุนูููุชู
            let toPaySeller = 0; // ูุงุด ูููุทุนู

            if(price === 0) {
                toPayNow = 15 * qty; // 15 ุฌููู ููู ูุฌุจุฉ ูุฌุงููุฉ
                toPaySeller = 0;
            } else {
                let total = price * qty;
                let comm = total * 0.15;
                toPayNow = comm * 2; // ุนูููุฉ ุงููุดุชุฑู + ุงููุทุนู
                toPaySeller = total - comm; // ุงูุตุงูู ููุจุงุฆุน
            }

            box.innerHTML = `
                <p>ุฑุณูู ุญุฌุฒ ูููููุน: <b>${toPayNow.toFixed(2)} ุฌ.ู</b></p>
                <p>ุจุงูู ุงูุญุณุงุจ ูููุทุนู: <b>${toPaySeller.toFixed(2)} ุฌ.ู</b></p>
            `;
            localStorage.setItem('finalCommission', toPayNow); // ุญูุธ ุนุดุงู ุตูุญุฉ ุงูุฏูุน
            localStorage.setItem('pendingQty', qty);
        }
        // ุชุดุบูู ุงูุญุณุจุฉ ูุฃูู ูุฑุฉ
        updateBill();

        function goToPay() {
            window.location.href = "pay.html";
        }
    </script>
</body>
</html>
