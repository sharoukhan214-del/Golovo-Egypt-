<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="stylesheet" href="Style.css">
    <title>إضافة وجبة</title>
</head>
<body>
    <div class="container">
        <h2>نشر وجبة فائضة</h2>
        <input type="text" id="mealName" placeholder="اسم الوجبة (مثلاً: وجبات إفطار فندقية)">
        
        <select id="mealType" onchange="checkFree()">
            <option value="paid">وجبة للبيع (عمولة 15%)</option>
            <option value="free">وجبة مجانية (بدون عمولة للبائع)</option>
        </select>

        <div id="priceSection">
            <input type="number" id="mealPrice" placeholder="سعر الوجبة الواحدة" oninput="calculateNet()">
            <p id="sellerNote" style="color: blue; font-size: 14px;"></p>
        </div>

        <input type="number" id="mealQty" placeholder="العدد المتاح (مثلاً 100 وجبة)">
        
        <button onclick="publish()" class="btn-main">نشر العرض الآن</button>
    </div>

    <script>
        function checkFree() {
            const type = document.getElementById('mealType').value;
            document.getElementById('priceSection').style.display = (type === 'free') ? 'none' : 'block';
        }

        function calculateNet() {
            let p = parseFloat(document.getElementById('mealPrice').value) || 0;
            if(p > 0) {
                let net = p - (p * 0.15); // البائع بيقبض 85%
                document.getElementById('sellerNote').innerText = `ستستلم من العميل: ${net.toFixed(2)} ج.م للوجبة.`;
            }
        }

        function publish() {
            const data = {
                name: document.getElementById('mealName').value,
                price: document.getElementById('mealType').value === 'free' ? 0 : document.getElementById('mealPrice').value,
                qty: document.getElementById('mealQty').value
            };
            localStorage.setItem('currentMeal', JSON.stringify(data)); // حفظ مؤقت للتجربة
            alert("تم النشر بنجاح!");
        }
    </script>
</body>
</html>
